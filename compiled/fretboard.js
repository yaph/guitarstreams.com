'use strict';function drawCircle(parent,cx,cy,radius){var fill=arguments.length>4&&arguments[4]!==undefined?arguments[4]:'#cccccc';var stroke=arguments.length>5&&arguments[5]!==undefined?arguments[5]:null;var stroke_width=arguments.length>6&&arguments[6]!==undefined?arguments[6]:null;var title=arguments.length>7&&arguments[7]!==undefined?arguments[7]:null;var circle=parent.append('svg:circle').attr('cx',cx).attr('cy',cy).attr('r',radius).style('fill',fill);if(stroke)circle.style('stroke',stroke);if(stroke_width)circle.style('stroke-width',stroke_width);if(title)circle.attr('title',title)}function drawFretboard(selector){var instrument=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'guitar';var notes=arguments.length>2&&arguments[2]!==undefined?arguments[2]:chromatic_scale;var fret_count=arguments.length>3&&arguments[3]!==undefined?arguments[3]:null;var selected_instrument=instruments[instrument];var roots=selected_instrument.roots;var string_gauges=selected_instrument.string_gauges;fret_count=fret_count||selected_instrument.fret_count;var svg=d3.select(selector);svg.selectAll('*').remove();var bbox=svg.node().parentElement.getBoundingClientRect();var width=bbox.width*0.95;var min_fret_distance=40;var max_fret_distance=140;var min_width=min_fret_distance*(fret_count+1);var max_width=max_fret_distance*(fret_count+1);width=d3.min([max_width,d3.max([min_width,width])]);var fret_distance=width/(fret_count+1);var string_distance=fret_distance*0.65;var string_padding=string_distance*0.1;var fret_padding=fret_distance*0.01;var margin_horizontal=fret_distance*0.8;var margin_vertical=string_distance*0.5;var height=string_distance*roots.length+margin_vertical;var string_width=width-margin_horizontal*1.2;var fret_markers=[3,5,7,9,12,15,17,19,21,24];var fret_height=string_distance*(roots.length-1);var fret_width=fret_distance*0.06;var note_radius=fret_distance*0.22;var note_stroke_width=note_radius*0.2;var note_font_size=note_radius*1.05;var fret_marker_radius=note_radius*0.3;svg.attr('width',width).attr('height',height);var transform='translate('+margin_horizontal+', '+margin_vertical+')';svg.append('rect').attr('x',0).attr('y',0).attr('width',width).attr('height',height).style('fill','#eeeeee');var g_frets=svg.append('g').attr('class','frets').attr('transform',transform);var g_fret_markers=svg.append('g').attr('class','fret-markers').attr('transform',transform);var g_strings=svg.append('g').attr('class','strings').attr('transform',transform);var g_notes=svg.append('g').attr('class','notes').attr('transform',transform);for(var i=0;i<=fret_count;i++){var offset=i*fret_distance;var stroke_width=fret_width;if(0==i)stroke_width*=1.5;g_frets.append('svg:line').attr('x1',offset).attr('y1',-string_padding/2).attr('x2',offset).attr('y2',fret_height+string_padding).style('stroke','#222222').style('stroke-width',stroke_width).append('title').text(i)}var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=fret_markers[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var _i3=_step.value;if(_i3>fret_count){break}var _cx=_i3*fret_distance-fret_distance/2;var _cy=height-margin_vertical-fret_marker_radius*3;if(0==_i3%12){var _offset2=fret_marker_radius*1.3;drawCircle(g_fret_markers,_cx+_offset2,_cy,fret_marker_radius);_cx-=_offset2}drawCircle(g_fret_markers,_cx,_cy,fret_marker_radius)}}catch(err){_didIteratorError=true;_iteratorError=err}finally{try{if(!_iteratorNormalCompletion&&_iterator.return){_iterator.return()}}finally{if(_didIteratorError){throw _iteratorError}}}for(var _i=0;_i<roots.length;_i++){var root=roots[_i];var _offset=_i*string_distance;g_strings.append('svg:line').attr('x1',-fret_padding/2).attr('y1',_offset).attr('x2',string_width+fret_padding).attr('y2',_offset).style('stroke','#444444').style('stroke-width',string_gauges[_i]*string_distance).append('title').text(root)}for(var _i2=0;_i2<roots.length;_i2++){var root_idx=noteIndex(roots[_i2]);for(var j=0;j<=fret_count;j++){var note_index=(root_idx+j)%chromatic_scale.length;var note=chromatic_scale[note_index];if(!notes.includes(note)){var enharmonic_note=enharmonic_notes[note];if(notes.includes(enharmonic_note)){note=enharmonic_note}else{continue}}var cx=j*fret_distance-fret_distance*0.5;var cy=_i2*string_distance;var x=cx-note_font_size*0.34;var y=cy+note_font_size*0.34;if(note.length>1){x=cx-note_font_size*0.5}drawCircle(g_notes,cx,cy,note_radius,'#ffffff','#aaaaaa',note_stroke_width,note);g_notes.append('svg:text').attr('x',x).attr('y',y).attr('fill','#000000').style('font-size',note_font_size+'px').text(noteLabel(note))}}}