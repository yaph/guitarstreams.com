'use strict';var selected_instrument='guitar';var selected_notes=chromatic_scale.slice();var selected_fret_count=15;var selected_root='C';var selected_mode='major';d3.select('input[value="'+selected_instrument+'"]').attr('checked',true);d3.select('#notes').attr('value',selected_notes.join(', '));d3.select('#fret-count').attr('value',selected_fret_count);showFretboard();d3.selectAll('input[name="instrument"]').on('change',function(){selected_instrument=d3.event.target.value;showFretboard()});d3.select('#notes').on('change',function(){selected_notes=d3.event.target.value.split(',').map(function(s){return noteDisplay(s)});showFretboard()});d3.select('#fret-count').on('change',function(){selected_fret_count=d3.max([3,~~d3.event.target.value]);showFretboard()});scaleOptions('#scale-root',chromatic_scale.slice(),function(d){return d||'Root'});scaleOptions('#scale-mode',d3.keys(scales),function(d){return d.replace('_',' ')||'Mode'});function noteDisplay(note){var s=note.trim();return s.charAt(0).toUpperCase()+s.slice(1)}function options(list){list.unshift('');return list}function setScale(){var target=d3.event.target;if(!target.value)return;if('scale-root'==target.id){selected_root=target.value}else if('scale-mode'==target.id){selected_mode=target.value}optionSelected('scale-root',selected_root);optionSelected('scale-mode',selected_mode);selected_notes=scale(selected_root,selected_mode).notes.slice(0,-1);d3.select('#notes').attr('value',selected_notes.join(', '));showFretboard()}function optionSelected(sid,value){d3.select('#'+sid+' option').attr('selected',null);d3.select('#'+sid+' option[value="'+value+'"]').attr('selected','selected')}function scaleOptions(selector,list,cb_text){d3.select(selector).on('change',setScale).selectAll('option').data(options(list)).enter().append('option').attr('value',function(d){return d}).text(cb_text)}function showFretboard(){drawFretboard('#fretboard',selected_instrument,selected_notes,selected_fret_count)}